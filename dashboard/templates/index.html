<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>SISMONICAMARAS Dashboard</title>
  <link rel="stylesheet" href="/static/style.css">
  <script>
    async function updateStatus() {
      const res = await fetch("/status");
      const data = await res.json();
      document.getElementById("inside").innerText = data.inside;
      document.getElementById("entered").innerText = data.entered;
      document.getElementById("exited").innerText = data.exited;
    }

    async function sendEvent(action) {
      await fetch(`/event/${action}`, { method: "POST" });
      updateStatus();
    }

    async function toggleCamera() {
      const res = await fetch("/toggle_camera", {method: "POST"});
      const data = await res.json();
      if (data.camera_active) {
          document.getElementById("videoFeed").src = "/video";
      } else {
          document.getElementById("videoFeed").src = "";
      }
    }

    setInterval(updateStatus, 2000);
    window.onload = updateStatus;
  </script>
</head>
<body>
  <!-- Encabezado con logo de la empresa -->
  <header>
    <h1 style="color: blue;">HI - TECH PEOPLE SAS</h1>
    <h2>Sistema de Monitoreo de CÃ¡maras</h2>
  </header>

  <!-- Controles de la cÃ¡mara -->
  <section class="camera-control" style="text-align:center; margin:20px;">
    <h3>ðŸ“· CÃ¡mara en Tiempo Real</h3>
    <button onclick="toggleCamera()" style="padding:10px 20px; background:blue; color:white; border-radius:10px;">
      Encender/Apagar CÃ¡mara
    </button>
    <div style="margin-top:15px;">
      <img id="videoFeed" src="" width="640" height="480" alt="Video en vivo"/>
    </div>
  </section>

  <!-- Estado -->
  <section class="status">
    <h3>ðŸ“Š Estado Actual</h3>
    <p><strong>Personas dentro:</strong> <span id="inside">0</span></p>
    <p><strong>Total Entradas:</strong> <span id="entered">0</span></p>
    <p><strong>Total Salidas:</strong> <span id="exited">0</span></p>
  </section>

  <!-- Controles manuales -->
  <section class="controls">
    <button onclick="sendEvent('entered')">âž• Entrada</button>
    <button onclick="sendEvent('exited')">âž– Salida</button>
  </section>

  <!-- Reportes -->
  <section class="reports">
    <h3>ðŸ“‘ Reportes</h3>
    <button onclick="window.location.href='/reports/daily'">Reporte Diario</button>
    <button onclick="window.location.href='/reports/weekly'">Reporte Semanal</button>
    <button onclick="window.location.href='/reports/monthly'">Reporte Mensual</button>
  </section>
</body>
</html>